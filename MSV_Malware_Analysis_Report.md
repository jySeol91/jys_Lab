# 2025-03-14 MSV 미탐 분석 보고서

## 파일 동작 구조

- `.msi` 파일 실행 시, 부모 프로세스인 `msiexec.exe`가 동작하며 동일한 이름의 자식 프로세스가 생성됨.
- 자식 프로세스는 임의의 `.tmp` 파일을 두 개 생성함.
- `msiexec.exe`는 Windows Installer로, MSI 패키지 설치, 수정, 제거에 사용되는 실행 파일.

### 첫 번째 `.tmp` 파일

```bash
"C:\Windows\Installer\MSIF1FF.tmp" /DontWait /HideWindow /dir "C:\Users\admin\AppData\Roaming\TypeFasterPortable"
```

- 실제 `.tmp`가 아닌 PE32 형식의 실행 파일.
- 숨겨진 창에서 설치 동작을 수행하며, 설치 디렉토리는 `C:\Users\admin\AppData\Roaming\TypeFasterPortable`.

### 두 번째 `.tmp` 파일

```bash
"C:\Windows\Installer\MSIF1FF.tmp" "C:\Windows\System32\rundll32.exe" "C:\Users\Admin\AppData\Roaming\TypeFasterPortable\meitneriumatm.dll",muirent
```

- `rundll32.exe`를 통해 `meitneriumatm.dll` 파일을 실행하려는 시도.
- 인자 `"muirent"`를 전달.
- 반복적으로 실행 경로와 인자를 설정하며 `ShellExecuteEx()` 함수 호출 결과를 출력.
- 문자열 `"Call to ShellExecuteEx() returned: true\r\n"` 포함.

### 기타 동작

- `.lnk` 파일(인터넷 바로가기 파일) 생성됨.
- DLL 호출 명령이 포함되어 있으나 해당 주소는 현재 활성화되어 있지 않음.
- 악성 동작이 일부 제거되었거나 비정상 상태일 가능성 존재.

---

## 주요 기능 요약

1. `.msi` 실행 시 `msiexec.exe` 부모-자식 구조 및 임의의 `.tmp` 파일 생성.
2. 첫 번째 `.tmp`: 설치 프로그램으로 동작, 숨김 모드 설치 진행.
3. 두 번째 `.tmp`: `rundll32.exe`로 DLL 실행 시도, 반복 명령 구조.
4. 문자열 처리 및 `ShellExecuteEx()` 함수 호출 포함.
5. `.lnk` 파일 생성 및 DLL 실행 주소 포함 → 비정상적으로 작동.
6. 악성코드 특유의 자동 실행 및 실행 루틴이 존재할 가능성.

---

## 악성 코드로 활용될 경우의 예상 동작

- **자기 방어:** 정상 파일로 위장하여 탐지를 회피.
- **원격 제어:** 외부 서버(C2)와 통신하며 명령 수신.
- **지속성 확보:** 재부팅 후에도 자동 실행 유지.
- **로그 은폐:** 정상 오류로 위장하여 탐지를 우회.
- **분석 회피:** 보안 도구 회피용 기능 내장.

---

## 결론

- 본 분석 대상은 RAT(Remote Access Trojan) 계열 악성코드 가능성 있음.
- **행위 기반 분석이 핵심**이며, 단순 파일 탐지로는 확인 어려움.
- 보안 장비는 **지속성 확보 및 C2 통신 기반의 탐지 우회 기법**을 고려해 개선되어야 함.
