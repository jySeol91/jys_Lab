# Cloudflare Turnstile API를 악용한 피싱 공격 분석 보고서

## 1. 개요

본 보고서는 Cloudflare의 Turnstile API를 악용한 다단계 피싱 공격에 대한 분석 결과를 담고 있습니다. 해당 공격은 삼성 이메일 사용자를 대상으로 하며, 정교한 리다이렉션 체인과 합법적인 CAPTCHA 서비스를 활용하여 사용자의 인증 정보를 탈취하려는 시도입니다.

## 2. 악성 이메일 특징

- **공격 유형**: Cloudflare Turnstile API를 악용한 고급 피싱 공격
- **타겟 사용자**: 삼성 이메일(@samsung.com) 사용자
- **전송 방식**: 이메일 첨부파일(HTML)

> **참고**: Cloudflare Turnstile은 봇과 인간을 구별하기 위해 사용되는 정상적인 CAPTCHA 솔루션입니다.

## 3. 악성 통신 구조 분석

공격은 다음 3단계의 통신 체인을 통해 이루어집니다:

| 단계 | 통신 주소 | 목적 |
|------|----------|------|
| 1 | `call_random_here.goldenterrytovvel.com/?CALL_RANDOM_HERE=test@samsung.com` | 초기 리다이렉션 및 타겟 이메일 수집 |
| 2 | `buetlmann.com/?email=test@samsung.com` | 삼성 보안 검증 페이지 위장 및 CAPTCHA 표시 |
| 3 | `solnik-ar.com/done.php?email=test@samsung.com` | 최종 자격 증명 탈취 페이지 |

## 4. 공격 흐름 상세 분석

### 4.1 첫 번째 통신 (초기 리다이렉션)

사용자가 악성 이메일의 링크 또는 첨부파일을 열면 다음과 같은 과정이 진행됩니다:

1. `call_random_here.goldenterrytovvel.com/?CALL_RANDOM_HERE=test@samsung.com` 주소로 초기 연결
2. HTTP 302 리다이렉션을 통해 사용자를 즉시 다음 단계로 리다이렉션
3. 이 과정은 매우 빠르게 진행되어 사용자가 리다이렉션을 인지하기 어려움
4. 쿼리 파라미터를 통해 타겟 이메일 주소가 다음 단계로 전달됨

### 4.2 두 번째 통신 (가짜 보안 검증 페이지)

리다이렉션된 `buetlmann.com/?email=test@samsung.com` 페이지는 다음과 같은 특징을 가집니다:

1. **삼성 보안 페이지 위장**:
   - 삼성 로고 및 디자인 도용
   - 공식 보안 검증 절차로 위장

2. **Cloudflare Turnstile 악용**:
   - 정상적인 Cloudflare Turnstile CAPTCHA 위젯 표시
   - "사람임을 증명하라"는 메시지와 함께 합법적인 CAPTCHA 제공

3. **의도적 오류 유발**:
   - 소스코드 분석 결과, 검증이 항상 실패하도록 설계:
   ```php
   echo json_encode(['success' => false, 'message' => 'Verification failed.']);
   ```
   
4. **강제 리다이렉션**:
   - CAPTCHA 작성과 상관없이 항상 verification 실패로 처리
   - 검증 실패 시 `muddy-haze-5069.zerotech672a2.workers.dev` 주소로 강제 리다이렉션
   - JavaScript를 통한 자동 리다이렉션 구현:
   ```javascript
   if (data.success) {
     // 이 부분은 절대 실행되지 않음
   } else {
     window.location.href = "muddy-haze-5069.zerotech672a2.workers.dev";
   }
   ```

### 4.3 세 번째 통신 (자격 증명 탈취)

최종 목적지인 `solnik-ar.com/done.php?email=test@samsung.com` 페이지는 다음과 같은 특징을 가집니다:

1. 삼성 로그인 페이지로 위장
2. 이메일 주소가 URL 파라미터로부터 자동 입력되어 표시
3. 사용자에게 비밀번호 입력 요구
4. 입력된 비밀번호는 공격자의 서버로 전송됨

## 5. 공격 기법 및 특징

1. **다단계 리다이렉션 체인**:
   - 여러 도메인을 거치는 리다이렉션으로 원래 출처 은폐
   - 보안 솔루션의 추적 및 분석 어렵게 함

2. **합법적 서비스 악용**:
   - Cloudflare Turnstile API(합법적 CAPTCHA 서비스) 악용
   - 사용자에게 신뢰감 부여 및 보안 솔루션 우회

3. **의도적 검증 실패**:
   - 항상 실패하도록 설계된 검증 로직으로 공격 체인 지속
   - 사용자 혼란을 유발하여 보안 의식 저하

4. **타켓팅된 공격**:
   - 특정 기업(삼성) 사용자를 대상으로 한 맞춤형 피싱
   - 이메일 주소를 쿼리 파라미터로 전달하여 개인화된 공격

## 6. 결론 및 대응 방안

본 분석을 통해 해당 악성 이메일은 Cloudflare Turnstile API를 악용한 다단계 피싱 공격으로 확인되었습니다. 정교한 리다이렉션 체인과 합법적인 보안 서비스를 악용하여 사용자 인증 정보를 탈취하는 고급 기법을 사용하고 있습니다.

### 권장 대응 방안:

1. **도메인 차단**:
   - 분석된 악성 도메인들을 조직의 방화벽 및 DNS 필터에서 즉시 차단
   - `goldenterrytovvel.com`, `buetlmann.com`, `solnik-ar.com`, `zerotech672a2.workers.dev` 도메인 차단

2. **이메일 보안 강화**:
   - 삼성 이메일 사용자들에게 보안 주의 알림 발송
   - 이메일 첨부 HTML 파일에 대한 샌드박스 검사 강화

3. **사용자 교육**:
   - 다중 리다이렉션에 대한 위험성 교육
   - 로그인 전 URL 확인 습관화 교육
   - CAPTCHA가 있다고 해서 항상 안전한 페이지가 아님을 인지시킴

4. **기술적 대응**:
   - 비정상적인 리다이렉션 체인 탐지 규칙 구현
   - 알려진 피싱 패턴을 기반으로 한 트래픽 모니터링 강화
   - 조직 내 엔드포인트 보안 솔루션에서 다단계 리다이렉션 패턴 감지 규칙 추가

5. **다중 인증 도입**:
   - 모든 중요 계정에 다중 인증(MFA) 의무화
   - 비정상적인 위치에서의 로그인 시도 차단

이러한 공격은 합법적인 서비스를 악용하고 다단계 리다이렉션을 활용하기 때문에 단일 보안 대책으로는 방어하기 어렵습니다. 따라서 다층적인 보안 접근 방식과 지속적인 사용자 교육이 필수적입니다.